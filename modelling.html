<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 4 Modelling | How-To iSSA</title>
<meta name="author" content="Julie W. Turner">
<meta name="author" content="Christina M. Prokopenko">
<meta name="author" content="Alec L. Robitaille">
<meta name="description" content="4.1 Guiding Questions What decisions did you make when creating your iSSAs and why? What is the biological or statistical justification for these decisions? How might your decisions impact your...">
<meta name="generator" content="bookdown 0.25.5 with bs4_book()">
<meta property="og:title" content="Chapter 4 Modelling | How-To iSSA">
<meta property="og:type" content="book">
<meta property="og:url" content="https://issa-guild.github.io/book/modelling.html">
<meta property="og:image" content="https://issa-guild.github.io/book/images/group.png">
<meta property="og:description" content="4.1 Guiding Questions What decisions did you make when creating your iSSAs and why? What is the biological or statistical justification for these decisions? How might your decisions impact your...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 4 Modelling | How-To iSSA">
<meta name="twitter:description" content="4.1 Guiding Questions What decisions did you make when creating your iSSAs and why? What is the biological or statistical justification for these decisions? How might your decisions impact your...">
<meta name="twitter:image" content="https://issa-guild.github.io/book/images/group.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">How-To iSSA</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="setup.html"><span class="header-section-number">2</span> Setup</a></li>
<li><a class="" href="preparation.html"><span class="header-section-number">3</span> Preparation</a></li>
<li><a class="active" href="modelling.html"><span class="header-section-number">4</span> Modelling</a></li>
<li><a class="" href="interpretation.html"><span class="header-section-number">5</span> Interpretation</a></li>
<li><a class="" href="resources.html"><span class="header-section-number">6</span> Resources</a></li>
<li><a class="" href="full-workflow.html"><span class="header-section-number">7</span> Full workflow</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/iSSA-guild/book">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="modelling" class="section level1">
<h1>
<span class="header-section-number">4</span> Modelling<a class="anchor" aria-label="anchor" href="#modelling"><i class="fas fa-link"></i></a>
</h1>
<div id="guiding-questions-2" class="section level2">
<h2>
<span class="header-section-number">4.1</span> Guiding Questions<a class="anchor" aria-label="anchor" href="#guiding-questions-2"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>What decisions did you make when creating your iSSAs and why?</li>
<li>What is the biological or statistical justification for these decisions?</li>
<li>How might your decisions impact your inferences?</li>
</ul>
<p>Often practitioners need to combine data from multiple individuals. If only
‘population-level’ inference is the goal, then include the same number of
clusters from each individual in a single model. An equal sampling intensity
helps address potential bias.</p>
</div>
<div id="model-building" class="section level2">
<h2>
<span class="header-section-number">4.2</span> Model Building<a class="anchor" aria-label="anchor" href="#model-building"><i class="fas fa-link"></i></a>
</h2>
<p>The model or model sets require justification. We direct to (Fieberg and Johnson
2015, Northrup et al. 2021) for detailed discussion and reference regarding
model building. We advocate for global models or distinct competing candidates
representing ecological processes. We do not recommend using a dredging
approach, or large candidate model sets, as it often results in the
interpretation of spurious results.</p>
</div>
<div id="two-step-approach" class="section level2">
<h2>
<span class="header-section-number">4.3</span> Two-step approach<a class="anchor" aria-label="anchor" href="#two-step-approach"><i class="fas fa-link"></i></a>
</h2>
<div id="step-1" class="section level3">
<h3>
<span class="header-section-number">4.3.1</span> Step 1<a class="anchor" aria-label="anchor" href="#step-1"><i class="fas fa-link"></i></a>
</h3>
<div class="inline-figure"><img src="https://badgen.net/badge/status/WIP/orange"></div>
<p>Global model or alternative hypotheses when the goal is to be descriptive of the ecological processes.</p>
<p>The global or alternative models can be composed of core or interest variables.</p>
<p>The concept of a core model is to identify key features of animal movement that are important but perhaps not the covariates of interest to the particular study or hypotheses. – Prokopenko et al 2017</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># &gt; code</span></code></pre></div>
<div id="troubleshooting-1" class="section level4">
<h4>
<span class="header-section-number">4.3.1.1</span> Troubleshooting<a class="anchor" aria-label="anchor" href="#troubleshooting-1"><i class="fas fa-link"></i></a>
</h4>
<p>Starting with simpler models could help to identify covariates that might be
causing problems</p>
<p>If there are no observations for certain categories or
interactions the model will likely not converge.</p>
</div>
</div>
<div id="step-2" class="section level3">
<h3>
<span class="header-section-number">4.3.2</span> Step 2<a class="anchor" aria-label="anchor" href="#step-2"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: lower-alpha">
<li><p>Bootstrap individual models to get population mean and CIs (Prokopenko et al.
2017, Scrafford et al. 2018)</p></li>
<li><p>Calculate a population level average by modelling each variable as a function
of anything that interacted with that variable and the availability as an
explanatory factor, with inverse variance as a weighting (Dickie et al. 2020) -
See Supplementary information.</p></li>
</ol>
</div>
</div>
<div id="mixed-model-approach" class="section level2">
<h2>
<span class="header-section-number">4.4</span> Mixed Model Approach<a class="anchor" aria-label="anchor" href="#mixed-model-approach"><i class="fas fa-link"></i></a>
</h2>
<p>(Muff et al. 2020)</p>
<p>Regarding our discussion of nesting random effects:
<a href="https://stats.stackexchange.com/questions/228800/crossed-vs-nested-random-effects-how-do-they-differ-and-how-are-they-specified" class="uri">https://stats.stackexchange.com/questions/228800/crossed-vs-nested-random-effects-how-do-they-differ-and-how-are-they-specified</a>
nested is notated as:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">group1</span> <span class="op">/</span> <span class="va">group2</span><span class="op">)</span></code></pre></div>
</div>
<div id="output" class="section level2">
<h2>
<span class="header-section-number">4.5</span> Output<a class="anchor" aria-label="anchor" href="#output"><i class="fas fa-link"></i></a>
</h2>
<p>Here we are just describing what you will see from your output.</p>
<div id="coefficients" class="section level3">
<h3>
<span class="header-section-number">4.5.1</span> Coefficients<a class="anchor" aria-label="anchor" href="#coefficients"><i class="fas fa-link"></i></a>
</h3>
<p>The estimates are the selection or movement coefficients, either for individuals or the population depending on your input data and model structure.</p>
<p>For a mixed model, the random effects output is relative to the fixed effect</p>
<p>To calculate individual selection coefficients = Fixed Effect + Random Effect</p>
</div>
<div id="std.-errorcis" class="section level3">
<h3>
<span class="header-section-number">4.5.2</span> Std. Error/CIs<a class="anchor" aria-label="anchor" href="#std.-errorcis"><i class="fas fa-link"></i></a>
</h3>
<p>Check the fixed and random effect standard errors to see if they are really large or NAs.</p>
<p>For example, note the NAs in the example model using land cover. In
the summary, at the bottom under “Conditional model”.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="fu">tar_read</span><span class="op">(</span><span class="va">model_lc</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##  Family: poisson  ( log )
## Formula:          
## case_ ~ -1 + I(log(sl_)) + I(log(sl_)):lc_adj + lc_adj + I(log(dist_to_water +  
##     1)) + I(log(dist_to_water + 1)):I(log(sl_)) + (1 | indiv_step_id) +  
##     (0 + I(log(sl_)) | id) + (0 + I(log(sl_)):lc_adj | id) +  
##     (0 + lc_adj | id) + (0 + I(log(dist_to_water + 1)) | id) +  
##     (0 + I(log(dist_to_water + 1)):I(log(sl_)) | id)
## Data: DT
## 
##      AIC      BIC   logLik deviance df.resid 
##       NA       NA       NA       NA    26488 
## 
## Random effects:
## 
## Conditional model:
##  Groups        Name                                  Variance Std.Dev. Corr 
##  indiv_step_id (Intercept)                           1.00e+06 1.00e+03      
##  id            I(log(sl_))                           1.87e-90 1.37e-45      
##  id.1          I(log(sl_)):lc_adjdisturbed           1.08e-02 1.04e-01      
##                I(log(sl_)):lc_adjforest              2.05e-03 4.52e-02 -1.00
##                I(log(sl_)):lc_adjopen                1.08e-01 3.28e-01  1.00
##                I(log(sl_)):lc_adjwetlands            2.05e-03 4.53e-02 -1.00
##  id.2          lc_adjdisturbed                       4.42e-01 6.64e-01      
##                lc_adjforest                          3.32e-02 1.82e-01 -1.00
##                lc_adjopen                            4.42e+00 2.10e+00  1.00
##                lc_adjwetlands                        2.38e-26 1.54e-13 -0.27
##  id.3          I(log(dist_to_water + 1))             1.34e-02 1.16e-01      
##  id.4          I(log(dist_to_water + 1)):I(log(sl_)) 5.26e-90 2.29e-45      
##              
##              
##              
##              
##              
##  -1.00       
##   1.00 -1.00 
##              
##              
##  -1.00       
##   0.30 -0.28 
##              
##              
## Number of obs: 26521, groups:  indiv_step_id, 2411; id, 6
## 
## Conditional model:
##                                       Estimate Std. Error z value Pr(&gt;|z|)
## I(log(sl_))                           -0.13107        NaN     NaN      NaN
## lc_adjdisturbed                       -3.74565        NaN     NaN      NaN
## lc_adjforest                          -3.42646        NaN     NaN      NaN
## lc_adjopen                            -5.94910        NaN     NaN      NaN
## lc_adjwetlands                        -3.67823        NaN     NaN      NaN
## I(log(dist_to_water + 1))             -0.03581        NaN     NaN      NaN
## I(log(sl_)):lc_adjforest               0.23726        NaN     NaN      NaN
## I(log(sl_)):lc_adjopen                 0.29305        NaN     NaN      NaN
## I(log(sl_)):lc_adjwetlands             0.28385        NaN     NaN      NaN
## I(log(sl_)):I(log(dist_to_water + 1))  0.00072        NaN     NaN      NaN</code></pre>
</div>
<div id="troubleshooting-2" class="section level3">
<h3>
<span class="header-section-number">4.5.3</span> Troubleshooting<a class="anchor" aria-label="anchor" href="#troubleshooting-2"><i class="fas fa-link"></i></a>
</h3>
<p>We have had success troubleshooting by putting the error in google and looking
for it as a github issue with the package or <code>lme4</code> since they’re built more or
less the same. Bolker has lots of hidden tips and tricks in there. Ben Bolker is
also very responsive.</p>
<p><a href="https://cran.r-project.org/web/packages/glmmTMB/vignettes/troubleshooting.html" class="uri">https://cran.r-project.org/web/packages/glmmTMB/vignettes/troubleshooting.html</a></p>
<p>Use <code><a href="https://rdrr.io/r/base/Random.html">set.seed()</a></code> to get the same model output, check that the output does not vary greatly with different seeds or when it is not set.</p>
<p>Be conservative in “trusting” the model.
Don’t accept models with any NAs in the response.</p>
<p>Unlike with <code>clogit</code> in <code>amt</code>, for <code>glmmTMB</code> simpler models do not always
improve convergence, but adding covariates with informative variation will
improve model performance and convergence.</p>
<p>We have found through trial and error that cos(TA) can make or break the model.
These poisson models seem to like lots of data and a fair number of variables,
but the optimizer is cranky. If you have too few, and they’re correlated/have
high VIF, then you will get NAs.</p>
<p>Use the performance package and the <code>check_model()</code> or <code>model_performance()</code> commands</p>
<p><code>glmmTMB</code> gives the Model convergence problem; non-positive-definite Hessian
matrix error very liberally. Generally, you don’t have to worry about it unless
you have other errors with it.</p>
<p><em>EXERCISE</em>: note of individuals or variables that are not converging or are on the extremes of response. Do they have different availability, fewer points, more NAs<img src="https://badgen.net/badge/status/WIP/orange"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># &gt; plot coefficient by sample size – is there a relationship?</span></code></pre></div>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="preparation.html"><span class="header-section-number">3</span> Preparation</a></div>
<div class="next"><a href="interpretation.html"><span class="header-section-number">5</span> Interpretation</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#modelling"><span class="header-section-number">4</span> Modelling</a></li>
<li><a class="nav-link" href="#guiding-questions-2"><span class="header-section-number">4.1</span> Guiding Questions</a></li>
<li><a class="nav-link" href="#model-building"><span class="header-section-number">4.2</span> Model Building</a></li>
<li>
<a class="nav-link" href="#two-step-approach"><span class="header-section-number">4.3</span> Two-step approach</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#step-1"><span class="header-section-number">4.3.1</span> Step 1</a></li>
<li><a class="nav-link" href="#step-2"><span class="header-section-number">4.3.2</span> Step 2</a></li>
</ul>
</li>
<li><a class="nav-link" href="#mixed-model-approach"><span class="header-section-number">4.4</span> Mixed Model Approach</a></li>
<li>
<a class="nav-link" href="#output"><span class="header-section-number">4.5</span> Output</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#coefficients"><span class="header-section-number">4.5.1</span> Coefficients</a></li>
<li><a class="nav-link" href="#std.-errorcis"><span class="header-section-number">4.5.2</span> Std. Error/CIs</a></li>
<li><a class="nav-link" href="#troubleshooting-2"><span class="header-section-number">4.5.3</span> Troubleshooting</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/iSSA-guild/book/blob/master/03-model.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/iSSA-guild/book/edit/master/03-model.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>How-To iSSA</strong>" was written by Julie W. Turner, Christina M. Prokopenko, Alec L. Robitaille. It was last built on 2022-04-11.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
