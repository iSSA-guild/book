[{"path":"index.html","id":"introduction","chapter":"1 Introduction","heading":"1 Introduction","text":"guide team effort curating insights solutions implementing\nintegrated step selection analyses (iSSAs) synthesizing past experiences,\nbest practices, key resources. Given difficult start \nintegrated step selection analysis choices need made, \ncreated approachable gateway world iSSAs. hope \nputting everything together help others. Please get touch \nquestions comments, suggested edits.guide integrates functions outputs targets-iSSA\nworkflow. targets manages \nrelationships data, variables intermediate outputs, well \nfunctions generate , ensures outdated objects regenerated.\nalso provides helpers flexibly batching steps across individuals, study\nperiods regions. Using targets workflow like one helped us\nrunning iSSAs caching data processing, saving computation time, \nprogramatically identifying dropping individuals time periods cause\nus headaches breaking runs outside type workflow. Starting \nworkflow, users can swap data, variables, questions without\nreinvent wheel.","code":""},{"path":"index.html","id":"acknowledgements","chapter":"1 Introduction","heading":"1.1 Acknowledgements","text":"Thank iSSA club alumni Katrien Kingdon, Levi Newediuk, Quinn Webber,\nEmilie Debedan, Eric Vander Wal motivation solve problems seek\nanswers. Extra thank Katrien reviewing document.Note: Everyone learns differently reading document may \nhelpful. Working group discussing issues peer immensely\nhelpful, even experienced practitioners. Every new analysis \nopportunity learn rethink current ideas.Thanks developers R, R packages, related software \nmake book related analyses possible. Specifically developers \ntargets, renv, bookdown, R, RStudio, amt, data.table, R-lib, R-spatial.","code":""},{"path":"setup.html","id":"setup","chapter":"2 Setup","heading":"2 Setup","text":"Start downloading cloning targets-issa project.\nDownload zipped project: targets-issa.zip\nClone: git clone https://github.com/iSSA-guild/targets-issa/\nDownload zipped project: targets-issa.zipClone: git clone https://github.com/iSSA-guild/targets-issa/Open RStudio project targets-issa repository.Install required packages.\nrenv::restore()\npackages error installing, make sure required\nsystem dependencies installed. try installing \ninstall.packages('package_name')\nRun renv::restore() \nrenv::restore()packages error installing, make sure required\nsystem dependencies installed. try installing \ninstall.packages('package_name')Run renv::restore() againRun targets workflow. defined script _targets.R.\nLoad targets library(targets)\nRun workflow tar_make()\nLoad targets library(targets)Run workflow tar_make()workflow running, print progress. green dot\nindicates targets run successfully, red\nX indicates targets hit error green check mark indicates\ntargets skipped already date.\nrun workflow, ‚Äôll output \nindividual targets tar_read(target_name). example, let‚Äôs read\nfirst five lines prepared example relocations.information targets, check \nmanual (start Walkthrough).","code":"\ntar_read(locs_prep)[1:5]"},{"path":"setup.html","id":"data","chapter":"2 Setup","heading":"2.1 Data","text":"Data specified ‚ÄúData‚Äù section _targets.R script.\npaths files required analysis specified, \nread using relevant function (eg. data.table::fread \nsf::st_read) targets workflow.","code":"# Data --------------------------------------------------------------------\n# Path to fisher locs data\nlocs_path <- file.path('input', 'fisher.csv')\n\n# Path to land cover, legend\nlc_path <- file.path('input', 'lc.tif')\nlegend_path <- file.path('input', 'fisher_legend.csv')\n\n# Path to elevation\nelev_path <- file.path('input', 'elev.tif')\n\n# Path to population density\npopdens_path <- file.path('input', 'popdens.tif')\n\n# Path to water\nwater_path <- file.path('input', 'water.gpkg')"},{"path":"setup.html","id":"variables","chapter":"2 Setup","heading":"2.2 Variables","text":"Variables specified ‚ÄúVariables‚Äù section _targets.R script.\nexample, column names x, y, datetime id input\nrelocation data resampling rate. required variables \nshown .","code":"# Variables ---------------------------------------------------------------\n# Targets: prepare\nid_col <- 'id'\ndatetime_col <- 't_'\nx_col <- 'x_'\ny_col <- 'y_'\nepsg <- 32618\ncrs <- st_crs(epsg)\ncrs_sp <- CRS(crs$wkt)\ntz <- 'America/New_York'\n\n# Targets: tracks\n# Split by: within which column or set of columns (eg. c(id, yr))\n#  do we want to split our analysis?\nsplit_by <- id_col\n\n# Resampling rate\nrate <- minutes(30)\n\n# Tolerance\ntolerance <- minutes(5)\n\n# Number of random steps\nn_random_steps <- 10"},{"path":"setup.html","id":"troubleshooting","chapter":"2 Setup","heading":"2.3 Troubleshooting","text":"","code":""},{"path":"setup.html","id":"glmmtmb","chapter":"2 Setup","heading":"2.3.1 glmmTMB","text":"issues installing glmmTMB Macs,\nsteps resolved .remove old versions TMB, glmmTMB, broom.mixedinstall xcode app store updates OS (takes )restart computerinstall TMBrestart Rinstall glmmTMB source (repeated warning posted link ok)install broom.mixed 0.2.7 using install.packages('broom.mixed')restart R","code":""},{"path":"setup.html","id":"tidyverse","chapter":"2 Setup","heading":"2.3.2 tidyverse","text":"‚Äòtidyverse‚Äô meta package made tidyverse packages. ‚Äòamt‚Äô relies\nheavily tidy packages use coding practices frequently. \npros cons discussed elsewhere. say \nmay want install entire ‚Äòtidyverse‚Äô package just ones\nnecessary analyses. may include ‚Äòdplyr‚Äô, ‚Äòtidyr‚Äô, ‚Äòggplot‚Äô,\n‚Äòlubridate‚Äô, etc.","code":""},{"path":"setup.html","id":"data.table","chapter":"2 Setup","heading":"2.3.3 data.table","text":"issues compiler Mac users. actually issue every packaged needs compiler. helpful sites set :https://github.com/Rdatatable/data.table/wiki/Installationhttps://stackoverflow.com/questions/65860439/installing-data-table--macoshttps://www.santoshsrinivas.com/installing-data-table--mac-osx/","code":""},{"path":"preparation.html","id":"preparation","chapter":"3 Preparation","heading":"3 Preparation","text":"","code":""},{"path":"preparation.html","id":"explore-data","chapter":"3 Preparation","heading":"3.1 Explore data","text":"","code":""},{"path":"preparation.html","id":"checking-the-sampling-rate","chapter":"3 Preparation","heading":"3.1.1 Checking the sampling rate","text":"","code":"\nsummarize_sampling_rate_many(tar_read(tracks), 'id')"},{"path":"preparation.html","id":"clean-data","chapter":"3 Preparation","heading":"3.2 Clean data","text":"","code":""},{"path":"preparation.html","id":"erroneous-locations","chapter":"3 Preparation","heading":"3.2.1 Erroneous locations","text":"amt package includes code guidelines data cleaning, Bj√∏rneraas et al.¬†(2010).major GPS cleaning considerations :censor locations pre- post- animal capture collaringlow quality data (based available measure precision, 2D/3D, DPOP, etc.)unreachable habitats occupyunrealistic step lengthsimmediate round tripsdrop offs/ mortalities","code":""},{"path":"preparation.html","id":"rarefication-and-autocorrelation","chapter":"3 Preparation","heading":"3.2.2 Rarefication and Autocorrelation","text":"early GPS RSF studies, autocorrelation viewed issue directly\neliminate. last two decades, however, discourse around\nautocorrelation become nuanced (Fieberg et al. 2021; Northrup et al. 2022). summarize current understanding, locations indeed ‚Äòserially\ndependent‚Äô ‚Äì points closer time closer space (Fleming et al. 2014). However, locations taken regular intervals, \nrepresentative space use (Fieberg et al. 2021). Sampling locations \nregular intervals best practice habitat selection analyses. ,\nautocorrelation bias reduce estimate uncertainty (SE). address\nconcern, using robust calculation confidence intervals can completed.","code":""},{"path":"preparation.html","id":"sample-available-steps","chapter":"3 Preparation","heading":"3.3 Sample Available Steps","text":"main assumption availability distribution defines \naccessible animal given location time. SSF specifically \nassumption addresses accessible animal can selected \nmakes next step.iSSA builds uses empirical observations movements inform\nprobability distributions, can modified including corresponding\ncovariates model.unit replication iSSA analysis clusters (strata) made used\nstep matches set available steps. Available steps sampled \ntentative distributions step length turn angle.","code":""},{"path":"preparation.html","id":"distributions","chapter":"3 Preparation","heading":"3.3.1 Distributions","text":"aware distribution drawing generate random steps.","code":""},{"path":"preparation.html","id":"step-length-distribution","chapter":"3 Preparation","heading":"3.3.1.1 Step Length Distribution","text":"four possible step length distributions:Exponential (step length)Half-Normal ([step-length]2)Log-Normal (log[step length]2 log[step length]Gamma (step length log[step length])focus Gamma, commonly used literature,\nprovide exponential examples. Gamma distribution shape\n(k) scale parameter (\\(\\theta\\), ‚Äòshape‚Äô ‚Äòscale‚Äô amt package. \nexponential distribution, special case gamma, rate\nparameter (lambda).Plot observed data fitted distributions assess \nagreement . distributions misclassify observations\n(normally miss extreme values)? negative speeds \npoint, calculate mean check. plots calculations done\nlevel estimated distributions, calculated random steps, model \nbehaviour. Check distribution seems fit best.","code":"\ntar_read(dist_sl_plots, 1)## $dist_sl_plots_8ba21cb0"},{"path":"preparation.html","id":"turn-angle-distribution","chapter":"3 Preparation","heading":"3.3.1.2 Turn Angle Distribution","text":"Prokopenko et al.¬†(2016) used uniform ta included cos(TA) \nadjust realistic variation directionality. Von Mises fit\nobserved points, including cos(TA) model might informative.\nconcentration parameter (k) ‚Äòkappa‚Äô amt, location parameter\n(\\(\\mu\\), mu amt).","code":"\ntar_read(dist_ta_plots, 1)## $dist_ta_plots_8ba21cb0## Warning: Removed 35 rows containing non-finite values (stat_density)."},{"path":"preparation.html","id":"individual-vs.-population-distributions","chapter":"3 Preparation","heading":"3.3.1.3 Individual vs.¬†Population Distributions","text":"generating random steps multiple animals, can either \nindividual population level distribution. generate random steps \nindividuals, amt package fitting parametric distribution step\nlength turn angle distributions given individual randomly\nselecting new steps .alternative, population level distribution can used, informs\nrandom steps individuals using population probability distribution.\nalso split movement distributions time day, season, even \nhabitat.generate random distributions changes comparisons used \navailable. example, generate distributions population \nrun individual models. results say individuals differ \npopulation movement behaviour. Let‚Äôs consider fast individual, population\nSL distribution used ln(SL) covariate positive \nadjust different. want compare individuals ,\nstarting baseline allows , \npopulation mean distribution recommended.summary, movement variation can accounted random step\ngeneration stage /model parameterization stage. reasons\neither, awareness one choose possible downstream\npatterns result critical.decisions can informed explore data.","code":""},{"path":"preparation.html","id":"number-of-random-steps","chapter":"3 Preparation","heading":"3.3.2 Number of random steps","text":"availability distribution defined randomly sampled steps step length turn angle probability distributions.Using 10 steps used step strata 11 steps common, \nintensity sampling varies across literature. Sensitivity analysis can \nconducted determine influence availability sample selection\n(Northrup et al. 2013, 2016). general piece advice ‚Äúleast one,\nmerrier‚Äù (Avgar Smith 2022)Generating tracks:Resampling tracks:Adding random steps:Researchers consider resolution habitat covariate step\nlength animal determine number steps required estimate \naccessible animal.","code":"make_track(locs_prep, x_, y_, t_, all_cols = TRUE, crs = epsg)resample_tracks(tracks, rate = rate, tolerance = tolerance)random_steps(tracks_resampled, n = n_random_steps)"},{"path":"preparation.html","id":"explore-data-1","chapter":"3 Preparation","heading":"3.4 Explore data","text":"","code":""},{"path":"preparation.html","id":"guiding-questions","chapter":"3 Preparation","heading":"3.4.1 Guiding Questions","text":"sample size data going model?data layer resolution extent?relate location data?movement vary within biological/ecological divisions?purpose exploring data brainstorm potential options \nmodels identify potential limitations. Proper exploration used (case\n= 1) available (case = 0) domains individual, population, season, year\netc. help inform downstream decisions troubleshoot convergence issues.","code":"\n# > table or figure sample size - # individuals and points per individual\n# > locations spread per season, year, individual: counts across categories\n# > density or histogram or box plot of covariates for used and available by any division that might be used in the model individual, year, season \n# > temporal extent and resolution \n# > spatial extent and resolution\n# > movement rates and turn angles by individual, season, time of day: mean, range, plots"},{"path":"preparation.html","id":"attribute-steps","chapter":"3 Preparation","heading":"3.5 Attribute steps","text":"End-point = selection processesStart-point = movement processesAttributes extracted start-point vary within cluster, can used interactions movement covariates habitat-selection covariates (end point)","code":""},{"path":"preparation.html","id":"choosing-covariates","chapter":"3 Preparation","heading":"3.5.1 Choosing covariates","text":"","code":""},{"path":"preparation.html","id":"guiding-questions-1","chapter":"3 Preparation","heading":"3.5.1.1 Guiding questions","text":"research objectives hypotheses?data layers need meet objectives test hypotheses?data layer resolution extent? relate location data?continuous categorical covariates best help answer research questions (computational limitations one )?","code":""},{"path":"preparation.html","id":"availability-threshold","chapter":"3 Preparation","heading":"3.5.2 Availability threshold","text":"Dickie et al.¬†(2020) used 0.01 ‚Äúthreshold‚Äù availability. .e.¬†included variable model available steps least 1% habitat type, otherwise booted . think typical choice 5%, Dickie able get reasonable estimates individuals fitting 1%.Depending many covariates model, many habitat classes (associated interactions) can really eat data. ‚Äôs worthwhile habitat point extraction GPS locations see habitat types relevant available individuals. can start combine habitat types. example, open vs closed, deciduous vs coniferous vs mixed, etc.","code":"\ntar_read(avail_lc)[id == 1016]"},{"path":"preparation.html","id":"selection","chapter":"3 Preparation","heading":"3.5.3 Selection","text":"Selection represented end-point step, .e., animal selects . covariate interest end point can interacted habitat metric preceding step one also end-point.Data types: continuous, categorical, BooleanImportant: discrete variable must coded factors.Transforming scaling covariates (GLMM TMB, scale critical \nmixed model, still helpful clogit models less necessary)extract_layers function user-facing function \ntargets-issa workflow flexibly sample relevant spatial layers.\nexample, samples land cover (point), elevation (point),\npopulation density (point), water (distance ). also\ncombines merges land cover legend provide useful\nland cover descriptions addition numeric ids.Scaling covariateswill influence magnitude coefficients, ideally scale covariates \nwithin order magnitude.distance features, likely follow decay function (.e.,\nlog-transformed). Note log() R natural logarithm, log base 10.","code":"\n# R/extract_layers.R\nextract_layersfunction (DT, crs, lc, legend, elev, popdens, water) \n{\n    setDT(DT)\n    start <- c(\"x1_\", \"y1_\")\n    end <- c(\"x2_\", \"y2_\")\n    extract_pt(DT, lc, end)\n    DT[legend, `:=`(lc_description, description), on = .(pt_lc = Value)]\n    extract_pt(DT, elev, end)\n    extract_pt(DT, popdens, end)\n    extract_distance_to(DT, water, end, crs)\n}"},{"path":"preparation.html","id":"movement","chapter":"3 Preparation","heading":"3.5.4 Movement","text":"look influences habitat movement interact covariate start step turn angle step length. Possible movement covariates include step length, ln[step length], [step length]2, ln[step length]2,cos[turn angle].","code":""},{"path":"preparation.html","id":"costa","chapter":"3 Preparation","heading":"3.5.4.1 Cos[TA]","text":"Cos(Turn Angle) converts circular measure linear -1 backwards, 0\nrandom walk, 1 moving forwards. Kappa concentration parameter \nvon-Mises distribution indicates directionality (increasing kappa \nforward movement)","code":""},{"path":"preparation.html","id":"lnsl","chapter":"3 Preparation","heading":"3.5.4.2 Ln[SL]","text":"Step Length included model scale gamma distribution Natural\nlogarithm step length, ln[Step Length+1], shape gamma\ndistribution. step length estimates 0 one \nadded, natural log 0 undefined.","code":""},{"path":"preparation.html","id":"other-covariate-notes","chapter":"3 Preparation","heading":"3.5.5 Other Covariate Notes","text":"","code":""},{"path":"preparation.html","id":"time-of-day","chapter":"3 Preparation","heading":"3.5.5.1 Time of Day","text":"Time day vary clusters. experience, ‚Äòtime day‚Äô \nnarrow definition twilight periods amt package. amt::time_of_day\nwrapped around maptools::crepuscule. potential underestimation\ncomes default solarDep / solar.dep, can adjusted. matters\nespecially fix rates longer crepuscule period \nmay fix period 1, leading underestimation.\nIdentifying crepuscule movements may matter analysis, case,\ndon‚Äôt include calculating time day (crepuscule = FALSE). \nneed include crepuscular movement, adjust default solarDep create\ncalculation (can link Katrien‚Äôs mine wolves).","code":"\n# > time of day"},{"path":"preparation.html","id":"interactions","chapter":"3 Preparation","heading":"3.5.5.2 Interactions","text":"included interactions, model estimate terms\nindependently well interaction. interaction :J betas\n, J, :J. J category estimates category.\nthree way interact :J:K, get estimates ,J,K, :J, :K,\nJ:K, :J:K.Running Model: Check correlation covariatesEXERCISE: Create table covariate corresponding\nprediction biological significance?\n\nExample Table: prediction covariates.","code":""},{"path":"modelling.html","id":"modelling","chapter":"4 Modelling","heading":"4 Modelling","text":"","code":""},{"path":"modelling.html","id":"guiding-questions-2","chapter":"4 Modelling","heading":"4.1 Guiding Questions","text":"decisions make creating iSSAs ?biological statistical justification decisions?might decisions impact inferences?Often practitioners need combine data multiple individuals. \n‚Äòpopulation-level‚Äô inference goal, include number \nclusters individual single model. equal sampling intensity\nhelps address potential bias.","code":""},{"path":"modelling.html","id":"model-building","chapter":"4 Modelling","heading":"4.2 Model Building","text":"model model sets require justification. direct (Fieberg Johnson\n2015, Northrup et al.¬†2021) detailed discussion reference regarding\nmodel building. advocate global models distinct competing candidates\nrepresenting ecological processes. recommend using dredging\napproach, large candidate model sets, often results \ninterpretation spurious results.","code":""},{"path":"modelling.html","id":"two-step-approach","chapter":"4 Modelling","heading":"4.3 Two-step approach","text":"","code":""},{"path":"modelling.html","id":"step-1","chapter":"4 Modelling","heading":"4.3.1 Step 1","text":"Global model alternative hypotheses goal descriptive ecological processes.global alternative models can composed core interest variables.concept core model identify key features animal movement important perhaps covariates interest particular study hypotheses. ‚Äì Prokopenko et al 2017","code":"\n# > code"},{"path":"modelling.html","id":"troubleshooting-1","chapter":"4 Modelling","heading":"4.3.1.1 Troubleshooting","text":"Starting simpler models help identify covariates might \ncausing problemsIf observations certain categories \ninteractions model likely converge.","code":""},{"path":"modelling.html","id":"step-2","chapter":"4 Modelling","heading":"4.3.2 Step 2","text":"Bootstrap individual models get population mean CIs (Prokopenko et al.\n2017, Scrafford et al.¬†2018)Bootstrap individual models get population mean CIs (Prokopenko et al.\n2017, Scrafford et al.¬†2018)Calculate population level average modelling variable function\nanything interacted variable availability \nexplanatory factor, inverse variance weighting (Dickie et al.¬†2020) -\nSee Supplementary information.Calculate population level average modelling variable function\nanything interacted variable availability \nexplanatory factor, inverse variance weighting (Dickie et al.¬†2020) -\nSee Supplementary information.","code":""},{"path":"modelling.html","id":"mixed-model-approach","chapter":"4 Modelling","heading":"4.4 Mixed Model Approach","text":"(Muff et al.¬†2020)Regarding discussion nesting random effects:\nhttps://stats.stackexchange.com/questions/228800/crossed-vs-nested-random-effects----differ-----specified\nnested notated :","code":"\n(1 | group1 / group2)"},{"path":"modelling.html","id":"output","chapter":"4 Modelling","heading":"4.5 Output","text":"just describing see output.","code":""},{"path":"modelling.html","id":"coefficients","chapter":"4 Modelling","heading":"4.5.1 Coefficients","text":"estimates selection movement coefficients, either individuals population depending input data model structure.mixed model, random effects output relative fixed effectTo calculate individual selection coefficients = Fixed Effect + Random Effect","code":""},{"path":"modelling.html","id":"std.-errorcis","chapter":"4 Modelling","heading":"4.5.2 Std. Error/CIs","text":"Check fixed random effect standard errors see really large NAs.example, note NAs example model using land cover. \nsummary, bottom ‚ÄúConditional model‚Äù.","code":"\nsummary(tar_read(model_lc))##  Family: poisson  ( log )\n## Formula:          \n## case_ ~ -1 + I(log(sl_)) + I(log(sl_)):lc_adj + lc_adj + I(log(dist_to_water +  \n##     1)) + I(log(dist_to_water + 1)):I(log(sl_)) + (1 | indiv_step_id) +  \n##     (0 + I(log(sl_)) | id) + (0 + I(log(sl_)):lc_adj | id) +  \n##     (0 + lc_adj | id) + (0 + I(log(dist_to_water + 1)) | id) +  \n##     (0 + I(log(dist_to_water + 1)):I(log(sl_)) | id)\n## Data: DT\n## \n##      AIC      BIC   logLik deviance df.resid \n##       NA       NA       NA       NA    26488 \n## \n## Random effects:\n## \n## Conditional model:\n##  Groups        Name                                  Variance Std.Dev. Corr \n##  indiv_step_id (Intercept)                           1.00e+06 1.00e+03      \n##  id            I(log(sl_))                           1.87e-90 1.37e-45      \n##  id.1          I(log(sl_)):lc_adjdisturbed           1.08e-02 1.04e-01      \n##                I(log(sl_)):lc_adjforest              2.05e-03 4.52e-02 -1.00\n##                I(log(sl_)):lc_adjopen                1.08e-01 3.28e-01  1.00\n##                I(log(sl_)):lc_adjwetlands            2.05e-03 4.53e-02 -1.00\n##  id.2          lc_adjdisturbed                       4.42e-01 6.64e-01      \n##                lc_adjforest                          3.32e-02 1.82e-01 -1.00\n##                lc_adjopen                            4.42e+00 2.10e+00  1.00\n##                lc_adjwetlands                        2.38e-26 1.54e-13 -0.27\n##  id.3          I(log(dist_to_water + 1))             1.34e-02 1.16e-01      \n##  id.4          I(log(dist_to_water + 1)):I(log(sl_)) 5.26e-90 2.29e-45      \n##              \n##              \n##              \n##              \n##              \n##  -1.00       \n##   1.00 -1.00 \n##              \n##              \n##  -1.00       \n##   0.30 -0.28 \n##              \n##              \n## Number of obs: 26521, groups:  indiv_step_id, 2411; id, 6\n## \n## Conditional model:\n##                                       Estimate Std. Error z value Pr(>|z|)\n## I(log(sl_))                           -0.13107        NaN     NaN      NaN\n## lc_adjdisturbed                       -3.74565        NaN     NaN      NaN\n## lc_adjforest                          -3.42646        NaN     NaN      NaN\n## lc_adjopen                            -5.94910        NaN     NaN      NaN\n## lc_adjwetlands                        -3.67823        NaN     NaN      NaN\n## I(log(dist_to_water + 1))             -0.03581        NaN     NaN      NaN\n## I(log(sl_)):lc_adjforest               0.23726        NaN     NaN      NaN\n## I(log(sl_)):lc_adjopen                 0.29305        NaN     NaN      NaN\n## I(log(sl_)):lc_adjwetlands             0.28385        NaN     NaN      NaN\n## I(log(sl_)):I(log(dist_to_water + 1))  0.00072        NaN     NaN      NaN"},{"path":"modelling.html","id":"troubleshooting-2","chapter":"4 Modelling","heading":"4.5.3 Troubleshooting","text":"success troubleshooting putting error google looking\ngithub issue package lme4 since ‚Äôre built \nless . Bolker lots hidden tips tricks . Ben Bolker \nalso responsive.https://cran.r-project.org/web/packages/glmmTMB/vignettes/troubleshooting.htmlUse set.seed() get model output, check output vary greatly different seeds set.conservative ‚Äútrusting‚Äù model.\nDon‚Äôt accept models NAs response.Unlike clogit amt, glmmTMB simpler models always\nimprove convergence, adding covariates informative variation \nimprove model performance convergence.found trial error cos(TA) can make break model.\npoisson models seem like lots data fair number variables,\noptimizer cranky. , ‚Äôre correlated/\nhigh VIF, get NAs.Use performance package check_model() model_performance() commandsglmmTMB gives Model convergence problem; non-positive-definite Hessian\nmatrix error liberally. Generally, don‚Äôt worry unless\nerrors .EXERCISE: note individuals variables converging extremes response. different availability, fewer points, NAs","code":"\n# > plot coefficient by sample size ‚Äì is there a relationship?"},{"path":"interpretation.html","id":"interpretation","chapter":"5 Interpretation","heading":"5 Interpretation","text":"","code":""},{"path":"interpretation.html","id":"whats-in-a-beta","chapter":"5 Interpretation","heading":"5.1 What‚Äôs in a beta?","text":"iSSA can pertain either selection movement behaviour. \nindicate directionality ecological significance effect size \nbehaviour clear without predicting model","code":""},{"path":"interpretation.html","id":"selection-1","chapter":"5 Interpretation","heading":"5.1.1 Selection","text":"Coefficient covariate indicates selection (+) avoidance (-)‚ÄúDistance-feature‚Äù covariate can tricky, positive coefficient\nindicates selection areas farther feature, means feature\navoided.","code":""},{"path":"interpretation.html","id":"movement-1","chapter":"5 Interpretation","heading":"5.1.2 Movement","text":"Coefficient log(Step Length) modifies shape parameter indicating (+) fewer long steps (-)Coefficient Step Length modifies scale parameter indicating longer (+) shorter steps (-)Coefficient cos(Turn Angle) indicates directionality movement, concentration parameter Von Mises","code":""},{"path":"interpretation.html","id":"presenting-coefficients","chapter":"5 Interpretation","heading":"5.1.3 Presenting coefficients","text":"","code":""},{"path":"interpretation.html","id":"table","chapter":"5 Interpretation","heading":"5.1.3.1 Table","text":"table coefficient error standard reporting results. \nrecommended presentations sole means presenting results.","code":"\nbroom.mixed::tidy(tar_read(model_forest), effects = 'fixed')"},{"path":"interpretation.html","id":"box-plots","chapter":"5 Interpretation","heading":"5.1.3.2 Box plots","text":"Boxplots can useful look general results variation \ncategories - time day, seasons. useful take note outlying\nindividuals investigate movement availability","code":"\ntar_read(plot_boxplot)"},{"path":"interpretation.html","id":"effect-sizes","chapter":"5 Interpretation","heading":"5.2 Effect Sizes","text":"strongly advocate going beyond presenting coefficients errors demonstrate effect sizes response across environmental variation.","code":""},{"path":"interpretation.html","id":"relative-selection-strength","chapter":"5 Interpretation","heading":"5.2.1 Relative Selection Strength","text":"Calculated animal selecting one spatial location (x1) another (x2) two locations except one habitat covariateCommon RSS expressions Avgar et al.¬†(2017), formulation depends covariates interest modelCan use predict function: https://rdrr.io/cran/amt/man/log_rss.html amt JWT code (see Full workflow example)Fieberg ‚Äò-‚Äô goes RSS maths (Fieberg et al. 2021)targets-issa workflow, predict H1, H2 forest using\nfollowing functions:can calculate RSS forest:finally, plots plot_rss function.","code":"\n# R/predict_h1_water.R\npredict_h1_waterfunction (DT, model) \n{\n    N <- 100L\n    new_data <- DT[, .(sl_ = mean(sl_), forest = 0, disturbed = 0, \n        dist_to_water = seq(from = 0, to = 1500, length.out = N), \n        indiv_step_id = NA), by = id]\n    new_data[, `:=`(h1_water, predict(model, .SD, type = \"link\", \n        re.form = NULL))]\n    new_data[, `:=`(x, seq(from = 0, to = 1500, length.out = N)), \n        by = id]\n}\n# R/predict_h2.R\npredict_h2function (DT, model) \n{\n    new_data <- DT[, .(sl_ = mean(sl_), forest = 0, disturbed = 0, \n        dist_to_water = median(dist_to_water, na.rm = TRUE), \n        indiv_step_id = NA), by = id]\n    new_data[, `:=`(h2, predict(model, .SD, type = \"link\", re.form = NULL))]\n}\n# R/calc_rss.R\ncalc_rssfunction (pred_h1, h1_col, pred_h2, h2_col) \n{\n    log_rss <- merge(pred_h1[, .SD, .SDcols = c(\"id\", \"x\", h1_col)], \n        pred_h2[, .SD, .SDcols = c(\"id\", h2_col)], by = \"id\", \n        all.x = TRUE)\n    log_rss[, `:=`(rss, h1 - h2), env = list(h1 = h1_col, h2 = h2_col)]\n}\ntar_read(plot_rss_forest)## `geom_smooth()` using method = 'loess' and formula 'y ~ x'"},{"path":"interpretation.html","id":"guiding-questions-3","chapter":"5 Interpretation","heading":"5.2.1.1 Guiding Questions","text":"present individuals drastic differences response - can find reason ?Take beta values interpret running RSS, sketch \npredictive figure expect relationships look like. \nmatch ?h values choose two locations t2 (x1 x2)? \nvalue h x2 ‚àÜh?: look distribution availability h\nmake sure biological justification.values choose interaction? looking \ninteraction try keep RSSs similar scale easy comparison. \nwildly different perhaps choose less extreme values - \nconsider biological realism.","code":""},{"path":"interpretation.html","id":"movement-2","chapter":"5 Interpretation","heading":"5.2.2 Movement","text":"Available steps drawn gamma distribution step lengths (shape, scale) von-Mises distribution turn angles (kappa, mu)","code":""},{"path":"interpretation.html","id":"speedstep-length","chapter":"5 Interpretation","heading":"5.2.2.1 Speed/Step Length","text":"Extract basal parameters:calculation Mean Step Length shape multiplied scale:","code":"\n# sl_distr_params(track)\n# ta_distr_params(track)\n# > code for this calculation\n# > example plot"},{"path":"interpretation.html","id":"negative-speed-estimates","chapter":"5 Interpretation","heading":"5.2.2.1.1 Negative Speed Estimates","text":"Negative speed estimates predictions can come modelsFirst check data ok (clean). erroneous locations, step lengths, turn angle? Trust observed (used) input data.Try another step-length distributionInclude interaction step length turn angleRemove ‚Äònon-movement‚Äô steps, short steps certain distance. Plot data determine non-movement behavioural modesResample data coarser resolution longer steps less non-movement steps.calculate speed exponential distribution?shapescale (kappatheta) mean expectation gamma. exponential\ndistribution, special case gamma, rate parameter\n(lambda). mean exponential 1/lambda, get\nmean speed tentative modified estimates. scale parameter \ninverse rate, gamma distributions. Exponential special\ncase shape = 1, using modifier log SL turns gamma. Thus,\nrate inverse scale, shape one. equations work .See Julie‚Äôs snail code .See distributions iSSA webinar files (Avgar Smith 2022)","code":""},{"path":"interpretation.html","id":"directionality","chapter":"5 Interpretation","heading":"5.2.2.2 Directionality","text":"Kappa concentration parameter von-Mises distribution indicates directionality (increasing kappa forward movement)","code":""},{"path":"interpretation.html","id":"negative-von-mises-estimates","chapter":"5 Interpretation","heading":"5.2.2.2.1 Negative Von Mises Estimates","text":"negative von Mises concentration parameter means adjusted turn angle distribution centred ùúã (180¬∞) rather 0 (negative directional autocorrelation; behaviourally animal likely turn back). can happen high resolution data. fix multiply -1 recenter distribution assumption around 0 ùúã.","code":"\n# > turn angle plot"},{"path":"interpretation.html","id":"model-validation-and-evaluation","chapter":"5 Interpretation","heading":"5.3 Model Validation and Evaluation","text":"Often researchers want determine performance reproducibility models.","code":""},{"path":"interpretation.html","id":"model-selection","chapter":"5 Interpretation","heading":"5.3.1 Model Selection","text":"","code":""},{"path":"interpretation.html","id":"aiclikelihood","chapter":"5 Interpretation","heading":"5.3.1.1 AIC/likelihood","text":"common create multiple candidate models select top performing\none. Performance can evaluated using variety measures, discuss\ncommon ones make recommendations.Competition candidate models works bias-variance trade-. \ntrade-can superseded large data sets favours complex\nmodels. Please read (Fieberg Johnson 2015, Northrup et al.¬†2021) \ndepth discussion building evaluating models.Likelihood ratios can used required.","code":"\n# > example"},{"path":"interpretation.html","id":"model-prediction","chapter":"5 Interpretation","heading":"5.3.2 Model Prediction","text":"","code":""},{"path":"interpretation.html","id":"k-fold-validation","chapter":"5 Interpretation","heading":"5.3.2.1 K-fold ‚ÄòValidation‚Äô","text":"philosophical analytical points made validation.First foremost, can‚Äôt expect models everything. models \nbuilt understand magnitude ecological effects responses, \nbuilt predict future ecological patterns (regardless underlying\necological mechanism). Habitat Selection Analysis work done \npurpose predicting areas conserve identifying important habitat \npopulations. Ideally, test run HSA, test \nanother population different time period. , question \npredict validate models don‚Äôt sample data? \nmany options k-fold really took hold (Boyce et al.¬†2002).method partition data ‚Äòk‚Äô number folds, withhold fold,\nrun model see well predicts left-fold. bin \nRSF predictions area rank , highest \nselected, take frequency used points bins. \nhigher correlation bin rank frequency, better modelNow, iSSAs HSAs use conditional logistic regression \ncan‚Äôt make predictive map easily (coming soon), Instead, option\nrank within strata/cluster used random points (Fortin et al.\n2009). Arguably, ideal restricted strata \nactually want validation extent study area.Quinn Webber‚Äôs social iSSA repository: https://github.com/qwebber/social-issa/k-fold procedure used critical mention done SSF validation sample discrimination test. important accurately state predictive validation, method attempts discriminate used step available step.Two alternative recommended options discrimination habitat calibration.","code":""},{"path":"interpretation.html","id":"discrimination-analyses","chapter":"5 Interpretation","heading":"5.3.2.2 Discrimination analyses","text":"correct discrimination index case-control models concordance (Brentnall et al.¬†2015). r package! https://cran.r-project.org/web/packages/survival/vignettes/concordance.pdf","code":""},{"path":"interpretation.html","id":"habitat-calibration","chapter":"5 Interpretation","heading":"5.3.2.3 Habitat calibration","text":"Habitat calibration plots way find predictive model, can considered true validation model (Fieberg et al.¬†2018)","code":"\n# > code for this?"},{"path":"resources.html","id":"resources","chapter":"6 Resources","heading":"6 Resources","text":"","code":""},{"path":"resources.html","id":"links","chapter":"6 Resources","heading":"6.1 Links","text":"Matthiopoulos, Fieberg Aarts. 2020. Species-Habitat Associations\nhttps://bookdown.org/jfieberg/SHABook/Matthiopoulos, Fieberg Aarts. 2020. Species-Habitat Associations\nhttps://bookdown.org/jfieberg/SHABook/Avgar Smith. 2022. iSSA. Statistical Methods Seminar Series. https://github.com/eco4cast/Statistical-Methods-Seminar-Series/tree/main/avgar-smith_issaAvgar Smith. 2022. iSSA. Statistical Methods Seminar Series. https://github.com/eco4cast/Statistical-Methods-Seminar-Series/tree/main/avgar-smith_issaGrurarie 2019. Making Predictive Maps RSFs. https://terpconnect.umd.edu/~egurarie/research/NWT/Step09_RSF_PartIV.htmlGrurarie 2019. Making Predictive Maps RSFs. https://terpconnect.umd.edu/~egurarie/research/NWT/Step09_RSF_PartIV.htmlGrurarie Palm. 2018. Modern Tools Spatial Modeling Animal Movement Analysis. AKTWS. https://terpconnect.umd.edu/~egurarie/teaching/SpatialModelling_AKTWS2018/index.htmlGrurarie Palm. 2018. Modern Tools Spatial Modeling Animal Movement Analysis. AKTWS. https://terpconnect.umd.edu/~egurarie/teaching/SpatialModelling_AKTWS2018/index.html","code":""},{"path":"resources.html","id":"packages","chapter":"6 Resources","heading":"6.2 Packages","text":"targets\nhttps://books.ropensci.org/targets\nhttps://books.ropensci.org/targets","code":""},{"path":"full-workflow.html","id":"full-workflow","chapter":"7 Full workflow","heading":"7 Full workflow","text":"","code":""},{"path":"full-workflow.html","id":"preface","chapter":"7 Full workflow","heading":"7.1 Preface","text":"example (Julie) ‚Äútalking‚Äù reader conducting iSSA \nfisher data set \ntargets workflow.","code":""},{"path":"full-workflow.html","id":"preparing-an-issa","chapter":"7 Full workflow","heading":"7.2 Preparing an iSSA","text":"","code":""},{"path":"full-workflow.html","id":"the-data","chapter":"7 Full workflow","heading":"7.2.1 The data","text":"critical data running iSSA x y coordinates GPS\nrelocations associated datetime timestamp. Depending ‚Äôre\n, ‚Äôll probably want know individual relocations belong\nwell.several things need done prior actually iSSAOverarchingly:Clean GPS dataPrepare layers covariate data","code":""},{"path":"full-workflow.html","id":"clean-the-gps-data","chapter":"7 Full workflow","heading":"7.2.1.1 Clean the GPS data","text":"Things need check clean met:Make sure observations (GPS points) completeif , remove incomplete observationsCheck duplicated GPS points (two taken time)remove duplicate observations","code":""},{"path":"full-workflow.html","id":"prepare-covariate-input-data","chapter":"7 Full workflow","heading":"7.2.1.2 Prepare covariate input data","text":"critical layers plan use GPS points \ncoordinate reference system. can take long time reproject layers,\ncrop , anything else need everything \n‚Äúworld,‚Äù critical later steps extracting covariates\nstep.","code":""},{"path":"full-workflow.html","id":"making-tracks","chapter":"7 Full workflow","heading":"7.2.2 Making tracks","text":"data clean, make points track. \none individual dataset, individual.Generating tracks:","code":"make_track(locs_prep, x_, y_, t_, all_cols = TRUE, crs = epsg)"},{"path":"full-workflow.html","id":"check-the-sampling-rate","chapter":"7 Full workflow","heading":"7.2.2.1 Check the sampling rate","text":"Now check sampling rate looks due messiness GPS\nrelocations.Data messy. iSSA, need GPS fixes happen regular intervals,\nindividuals model, likely need resample \ndata.targets workflow, simplified . , \nbeginning workflow: fill \nVariables match data.","code":"\nsummarize_sampling_rate_many(tar_read(tracks), 'id')resample_tracks(tracks, rate = rate, tolerance = tolerance)# Variables ---------------------------------------------------------------\n# Targets: prepare\nid_col <- 'id'\ndatetime_col <- 't_'\nx_col <- 'x_'\ny_col <- 'y_'\nepsg <- 32618\ncrs <- st_crs(epsg)\ncrs_sp <- CRS(crs$wkt)\ntz <- 'America/New_York'\n\n# Targets: tracks\n# Split by: within which column or set of columns (eg. c(id, yr))\n#  do we want to split our analysis?\nsplit_by <- id_col\n\n# Resampling rate\nrate <- minutes(30)\n\n# Tolerance\ntolerance <- minutes(5)\n\n# Number of random steps\nn_random_steps <- 10"},{"path":"full-workflow.html","id":"steps","chapter":"7 Full workflow","heading":"7.2.3 Steps","text":"Now tracks, step selection analysis requires steps! , \ntargets workflow, keep data individuals least 3 steps,\nadjustable depending need.","code":""},{"path":"full-workflow.html","id":"check-the-distribution-of-steps-and-turn-angles","chapter":"7 Full workflow","heading":"7.2.3.1 Check the distribution of steps and turn angles","text":"Now make sure aren‚Äôt biological impossibilities steps.\nUsually lot little steps big steps, good\ncheck make sure erroneous observations removed. instance, \nshow steps biologically possible. also\nshows distribution know use Gamma exponential\ndistribution generating random steps. Gamma, \ndefault amt.SL distribution 1 individualTA distribution 1 individual","code":"\ntar_read(dist_sl_plots, 1)## $dist_sl_plots_8ba21cb0\ntar_read(dist_ta_plots, 1)## $dist_ta_plots_8ba21cb0## Warning: Removed 35 rows containing non-finite values (stat_density)."},{"path":"full-workflow.html","id":"prepare-the-data-to-go-into-the-issa","chapter":"7 Full workflow","heading":"7.2.4 Prepare the data to go into the iSSA","text":", point, observed steps know distributions\nlook like. Now can use information properly inform random steps\ncorrect distribution. create random steps, also\nextract covariates interest step.","code":""},{"path":"full-workflow.html","id":"motivation-vs-selection","chapter":"7 Full workflow","heading":"7.2.4.1 Motivation vs Selection","text":"One critical decisions make analysis want know \nvariable motivating /animal moves vs.¬†animal selecting\nvariable; decision influences use information \nstart step (motivation) vs.¬†end step (selection) \nanalysis. decision course determined question hypothesesSee Choosing covariates info","code":""},{"path":"full-workflow.html","id":"example-extraction","chapter":"7 Full workflow","heading":"7.2.4.2 Example extraction","text":"example, creating random steps extracting information \nlandcover class distance water individual selects (end step) \ntime day (day night start step) time step.\ncreate dataset includes step length, turn angle, whether ‚Äôs\nday night start step, land class animal \nend step.NOTE: targets workflow, created extraction functions\ninstead using amt‚Äôs extract_covariate time_of_day functions. \nseveral reasons - flexibility - amt isn‚Äôt functional terra\nyet (coming soon) - time_of_day good day vs night, want dawn\ndusk, ‚Äôs great larger fixrates. instance, 2 hour\nfixrate, rarely includes dawn dusk time frames narrow \ndefault maptools function time_of_day wraps around. \ncircumstance, created time day extractions needed \nlocation. However, fisher example 30 minute fixrate,\nincluding default crepuscular times fine.multiple hypotheses benefit know information \nbeginning end step, can input\"\" instead \n\"start\" \"end\"., end, get dataset looks something like:","code":"\n# R/extract_layers.R\nextract_layersfunction (DT, crs, lc, legend, elev, popdens, water) \n{\n    setDT(DT)\n    start <- c(\"x1_\", \"y1_\")\n    end <- c(\"x2_\", \"y2_\")\n    extract_pt(DT, lc, end)\n    DT[legend, `:=`(lc_description, description), on = .(pt_lc = Value)]\n    extract_pt(DT, elev, end)\n    extract_pt(DT, popdens, end)\n    extract_distance_to(DT, water, end, crs)\n}"},{"path":"full-workflow.html","id":"running-an-issa","chapter":"7 Full workflow","heading":"7.3 Running an iSSA","text":"workflow going example using Poisson point process method\ndescribed Muff et al (2020). method allows us look individuals\ncan examine individual- population-level responses \n. example, ‚Äôre going include categorical continuous\nvariables.NOTE: Random effects GLMMs supposed 5 levels, \nmeans least 5 individuals want include \nrandom effect.looking output model, see issues. First ,\nwarnings model. positive hessian warning applied\nliberally glmmTMB, real sign problem NAs reported \nvariation. model didn‚Äôt converge properly, need look .Things explore data level include:lots NAs particular variable (helpful tips Bolker)lots variation little variation particular variableavailability variables individualsThings explore model level include:model -parameterized amount datathe high variance assigned strata level another random effectvariables similarly scaledif using Muff method, strata represent step id individual\n(indiv_step_id), step id assigned amt way\ncoded, numbers restart individualcategorical variables classified factors, especially indiv_step_idrandom effects least 5 levels (likely going \nproblem iSSAs, come )exploration, ‚Äôm thinking model -parameterized 6\nindividuals, least many landcover classes. , ‚Äôm going pretend\nexample care selection forest disturbed\nhabitats. created dummy variables based extracted landcover\ndata ran iSSA data.model runs without issue.","code":"\n# R/model_land_cover.R\nmodel_land_coverfunction (DT) \n{\n    glmmTMB(case_ ~ -1 + I(log(sl_)) + I(log(sl_)):lc_adj + lc_adj + \n        I(log(dist_to_water + 1)) + I(log(dist_to_water + 1)):I(log(sl_)) + \n        (1 | indiv_step_id) + (0 + I(log(sl_)) | id) + (0 + I(log(sl_)):lc_adj | \n        id) + (0 + lc_adj | id) + (0 + I(log(dist_to_water + \n        1)) | id) + (0 + I(log(dist_to_water + 1)):I(log(sl_)) | \n        id), data = DT, family = poisson(), map = list(theta = factor(c(NA, \n        1:23))), start = list(theta = c(log(1000), seq(0, 0, \n        length.out = 23))))\n}\nsummary(tar_read(model_lc))##  Family: poisson  ( log )\n## Formula:          \n## case_ ~ -1 + I(log(sl_)) + I(log(sl_)):lc_adj + lc_adj + I(log(dist_to_water +  \n##     1)) + I(log(dist_to_water + 1)):I(log(sl_)) + (1 | indiv_step_id) +  \n##     (0 + I(log(sl_)) | id) + (0 + I(log(sl_)):lc_adj | id) +  \n##     (0 + lc_adj | id) + (0 + I(log(dist_to_water + 1)) | id) +  \n##     (0 + I(log(dist_to_water + 1)):I(log(sl_)) | id)\n## Data: DT\n## \n##      AIC      BIC   logLik deviance df.resid \n##       NA       NA       NA       NA    26488 \n## \n## Random effects:\n## \n## Conditional model:\n##  Groups        Name                                  Variance Std.Dev. Corr \n##  indiv_step_id (Intercept)                           1.00e+06 1.00e+03      \n##  id            I(log(sl_))                           1.87e-90 1.37e-45      \n##  id.1          I(log(sl_)):lc_adjdisturbed           1.08e-02 1.04e-01      \n##                I(log(sl_)):lc_adjforest              2.05e-03 4.52e-02 -1.00\n##                I(log(sl_)):lc_adjopen                1.08e-01 3.28e-01  1.00\n##                I(log(sl_)):lc_adjwetlands            2.05e-03 4.53e-02 -1.00\n##  id.2          lc_adjdisturbed                       4.42e-01 6.64e-01      \n##                lc_adjforest                          3.32e-02 1.82e-01 -1.00\n##                lc_adjopen                            4.42e+00 2.10e+00  1.00\n##                lc_adjwetlands                        2.38e-26 1.54e-13 -0.27\n##  id.3          I(log(dist_to_water + 1))             1.34e-02 1.16e-01      \n##  id.4          I(log(dist_to_water + 1)):I(log(sl_)) 5.26e-90 2.29e-45      \n##              \n##              \n##              \n##              \n##              \n##  -1.00       \n##   1.00 -1.00 \n##              \n##              \n##  -1.00       \n##   0.30 -0.28 \n##              \n##              \n## Number of obs: 26521, groups:  indiv_step_id, 2411; id, 6\n## \n## Conditional model:\n##                                       Estimate Std. Error z value Pr(>|z|)\n## I(log(sl_))                           -0.13107        NaN     NaN      NaN\n## lc_adjdisturbed                       -3.74565        NaN     NaN      NaN\n## lc_adjforest                          -3.42646        NaN     NaN      NaN\n## lc_adjopen                            -5.94910        NaN     NaN      NaN\n## lc_adjwetlands                        -3.67823        NaN     NaN      NaN\n## I(log(dist_to_water + 1))             -0.03581        NaN     NaN      NaN\n## I(log(sl_)):lc_adjforest               0.23726        NaN     NaN      NaN\n## I(log(sl_)):lc_adjopen                 0.29305        NaN     NaN      NaN\n## I(log(sl_)):lc_adjwetlands             0.28385        NaN     NaN      NaN\n## I(log(sl_)):I(log(dist_to_water + 1))  0.00072        NaN     NaN      NaN\n# checking availability \n# for landcover\ntar_read(avail_lc)\n# for distance to water\ntracks_extract <- tar_read(tracks_extract)\ntracks_extract[!(case_), quantile(dist_to_water, na.rm = TRUE), by = id]\n# R/model_forest_bin.R\nmodel_forest_binfunction (DT) \n{\n    glmmTMB(case_ ~ -1 + I(log(sl_)) + I(log(sl_)):forest + forest + \n        I(log(sl_)):disturbed + disturbed + I(log(dist_to_water + \n        1)) + I(log(dist_to_water + 1)):I(log(sl_)) + (1 | indiv_step_id) + \n        (0 + I(log(sl_)) | id) + (0 + I(log(sl_)):disturbed | \n        id) + (0 + I(log(sl_)):forest | id) + (0 + forest | id) + \n        (0 + disturbed | id) + (0 + I(log(dist_to_water + 1)) | \n        id) + (0 + I(log(dist_to_water + 1)):I(log(sl_)) | id), \n        data = DT, family = poisson(), map = list(theta = factor(c(NA, \n            1:7))), start = list(theta = c(log(1000), seq(0, \n            0, length.out = 7))))\n}\nsummary(tar_read(model_forest))##  Family: poisson  ( log )\n## Formula:          \n## case_ ~ -1 + I(log(sl_)) + I(log(sl_)):forest + forest + I(log(sl_)):disturbed +  \n##     disturbed + I(log(dist_to_water + 1)) + I(log(dist_to_water +  \n##     1)):I(log(sl_)) + (1 | indiv_step_id) + (0 + I(log(sl_)) |  \n##     id) + (0 + I(log(sl_)):disturbed | id) + (0 + I(log(sl_)):forest |  \n##     id) + (0 + forest | id) + (0 + disturbed | id) + (0 + I(log(dist_to_water +  \n##     1)) | id) + (0 + I(log(dist_to_water + 1)):I(log(sl_)) |      id)\n## Data: DT\n## \n##      AIC      BIC   logLik deviance df.resid \n##    49162    49276   -24567    49134    26507 \n## \n## Random effects:\n## \n## Conditional model:\n##  Groups        Name                                  Variance Std.Dev.\n##  indiv_step_id (Intercept)                           1.00e+06 1.00e+03\n##  id            I(log(sl_))                           1.26e-09 3.55e-05\n##  id.1          I(log(sl_)):disturbed                 7.67e-04 2.77e-02\n##  id.2          I(log(sl_)):forest                    2.65e-10 1.63e-05\n##  id.3          forest                                1.77e-02 1.33e-01\n##  id.4          disturbed                             1.23e-10 1.11e-05\n##  id.5          I(log(dist_to_water + 1))             1.34e-02 1.16e-01\n##  id.6          I(log(dist_to_water + 1)):I(log(sl_)) 1.55e-11 3.93e-06\n## Number of obs: 26521, groups:  indiv_step_id, 2411; id, 6\n## \n## Conditional model:\n##                                       Estimate Std. Error z value Pr(>|z|)    \n## I(log(sl_))                            0.07923    0.07735    1.02    0.306    \n## forest                                 0.34653    0.19410    1.79    0.074 .  \n## disturbed                             -0.19495    0.27753   -0.70    0.482    \n## I(log(dist_to_water + 1))              0.08271    0.08956    0.92    0.356    \n## I(log(sl_)):forest                    -0.05632    0.03635   -1.55    0.121    \n## I(log(sl_)):disturbed                 -0.24794    0.05330   -4.65  3.3e-06 ***\n## I(log(sl_)):I(log(dist_to_water + 1))  0.00875    0.01142    0.77    0.444    \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"full-workflow.html","id":"interpretation-1","chapter":"7 Full workflow","heading":"7.4 Interpretation","text":"Demonstrating effects iSSA output area see lot \ndifferent avenues point. just show beta estimates \nmodel p-values. , however can result misinterpretation biological significance (Avgar et al. 2017).","code":""},{"path":"full-workflow.html","id":"relative-selection-strength-1","chapter":"7 Full workflow","heading":"7.4.1 Relative Selection Strength","text":"Relative Selection Strength (RSS) comes . Avgar et al (2017)\nderived various equations calculate RSS depending variables \n, interacted others, log-transformed, etc. However, since \nBrian Smith determined using predict() function can achieve \noutcome (see proof Smith 2020).\nmathematical details.\nRSSs really comparing selection strength habitat location 1 (H1) compared location 2 (H2)., say animal forest, relatively\nlikely select forest avoid forest? RSS shows\nstrength selection avoidance range habitat values \nhabitat type.targets-issa workflow, predict H1, H2 forest using\nfollowing functions:finally, plots plot_rss function.JWT comment: personally find hard wrap head around RSSs \ncategorical variables, don‚Äôt great way explaining others\nlike didn‚Äôt get . closest can describe , say, looking \nplot, individual starts forest, next step likely go\nforest . continuous nature RSS hard wrap head\naround categorical variable. just pretend head ‚Äôs \nproportional value ‚Äòforest‚Äô = 0 ‚Äòforest‚Äô = 1, middle \nestimate based model. ‚Äôs perfect, ‚Äôs best ‚Äôve \nable come terms . :shrug: #OverlyHonestMethodsWe can thing determine RSS distance water.RSSs done one habitat time. said, interactions can \nexplored pre-determining cut points examine one variables \ntime. know sounds confusing. , example, selection forest\ninteracted distance road. Say want understand animals select\nforest near far roads. , define near road\n100m road far road 5000m road.\nvalues semi-arbitrary, based biology \nanimal. complicates calculation RSS bit, making two step\nprocess predict method. first calculate overall\nselection , case, forest 100m road, run run\npredict function availability forest add together.","code":"\n# R/predict_h1_forest.R\npredict_h1_forest## function (DT, model) \n## {\n##     N <- 100L\n##     new_data <- DT[, .(sl_ = mean(sl_), forest = seq(from = 0, \n##         to = 1, length.out = N), disturbed = 0, dist_to_water = median(dist_to_water, \n##         na.rm = TRUE), indiv_step_id = NA), by = id]\n##     new_data[, `:=`(h1_forest, predict(model, .SD, type = \"link\", \n##         re.form = NULL))]\n##     new_data[, `:=`(x, seq(from = 0, to = 1, length.out = N)), \n##         by = id]\n## }\n# R/predict_h2.R\npredict_h2## function (DT, model) \n## {\n##     new_data <- DT[, .(sl_ = mean(sl_), forest = 0, disturbed = 0, \n##         dist_to_water = median(dist_to_water, na.rm = TRUE), \n##         indiv_step_id = NA), by = id]\n##     new_data[, `:=`(h2, predict(model, .SD, type = \"link\", re.form = NULL))]\n## }\n# Then we can calculate RSS for forest as H1 - H2:\n\n# R/calc_rss.R\ncalc_rss## function (pred_h1, h1_col, pred_h2, h2_col) \n## {\n##     log_rss <- merge(pred_h1[, .SD, .SDcols = c(\"id\", \"x\", h1_col)], \n##         pred_h2[, .SD, .SDcols = c(\"id\", h2_col)], by = \"id\", \n##         all.x = TRUE)\n##     log_rss[, `:=`(rss, h1 - h2), env = list(h1 = h1_col, h2 = h2_col)]\n## }\ntar_read(plot_rss_forest)## `geom_smooth()` using method = 'loess' and formula 'y ~ x'\ntar_read(plot_rss_water)## `geom_smooth()` using method = 'loess' and formula 'y ~ x'"},{"path":"full-workflow.html","id":"speed","chapter":"7 Full workflow","heading":"7.4.2 Speed","text":"Speed different kettle fish. people show box plots step length\ngive idea speed, partial show effect size (\nphrased well ‚Äì fix). using gamma distribution iSSA, \nmean estimated speed shape parameter multiplied scale parameter \ngamma distribution. However, shape modified movement variables\niSSA . calculation becomes\\(\\text{mean estimated speed} = (shape + logSL.beta + logSLintx.beta*mean(.interacted.))*scale\\), toy example, done . , can pick \ncovariate want vary estimate speed see speed impacted \ninteracted . seq represents range values ‚Äôre looking .Let‚Äôs see fishers‚Äô speed changes areas without anthropogenic disturbance vs areas disturbed (seq = 0:1)","code":"\n# R/calc_speed.R\ncalc_speed## function (DT, covariate, seq) \n## {\n##     if (covariate == \"forest\") \n##         DT[, `:=`(spd = list(list((shape + `I(log(sl_))` + `I(log(sl_)):forest` * \n##             seq + `I(log(sl_)):disturbed` + `I(log(dist_to_water + 1)):I(log(sl_))` * \n##             median.water) * (scale))), x = list(list(seq))), \n##             by = .(id)]\n##     if (covariate == \"disturbed\") \n##         DT[, `:=`(spd = list(list((shape + `I(log(sl_))` + `I(log(sl_)):forest` + \n##             `I(log(sl_)):disturbed` * seq + `I(log(dist_to_water + 1)):I(log(sl_))` * \n##             median.water) * (scale))), x = list(list(seq))), \n##             by = .(id)]\n##     if (covariate == \"dist_to_water\") \n##         DT[, `:=`(spd = list(list((shape + `I(log(sl_))` + `I(log(sl_)):forest` + \n##             `I(log(sl_)):disturbed` + `I(log(dist_to_water + 1)):I(log(sl_))` * \n##             seq) * (scale))), x = list(list(seq))), by = .(id)]\n##     move <- DT[, .(spd = unlist(spd), x = unlist(x)), by = .(id)]\n##     move\n## }\ntar_read(plot_speed_disturbed)"},{"path":"references.html","id":"references","chapter":"References","heading":"References","text":"Allaire, JJ, Yihui Xie, Jonathan McPherson, Javier Luraschi, Kevin Ushey, Aron Atkins, Hadley Wickham, Joe Cheng, Winston Chang, Richard Iannone. 2022. Rmarkdown: Dynamic Documents R. https://CRAN.R-project.org/package=rmarkdown.Almende B.V. Contributors, Benoit Thieurmel, Titouan Robert. 2021. VisNetwork: Network Visualization Using Vis.js Library. http://datastorm-open.github.io/visNetwork/.Arnold, Jeffrey B. 2021. Ggthemes: Extra Themes, Scales Geoms Ggplot2. https://github.com/jrnold/ggthemes.Avgar, Tal, Subhash R. Lele, Jonah L. Keim, Mark S. Boyce. 2017. ‚ÄúRelative Selection Strength: Quantifying Effect Size Habitat- Step-Selection Inference.‚Äù Ecology Evolution 7 (14): 5322‚Äì30. https://doi.org/10.1002/ece3.3122.Bivand, Roger S., Edzer Pebesma, Virgilio Gomez-Rubio. 2013. Applied Spatial Data Analysis R, Second Edition. Springer, NY. https://asdar-book.org/.Bj√∏rneraas, Kari, Bram Van Moorter, Christer Moe Rolandsen, Ivar Herfindal. 2010. ‚ÄúScreening Global Positioning System Location Data Errors Using Animal Movement Characteristics.‚Äù Journal Wildlife Management 74 (6): 1361‚Äì6.Boyce, Mark S, Pierre R Vernier, Scott E Nielsen, Fiona KA Schmiegelow. 2002. ‚ÄúEvaluating Resource Selection Functions.‚Äù Ecological Modelling 157 (2-3): 281‚Äì300.Brentnall, Adam R, Jack Cuzick, John Field, Stephen W Duffy. 2015. ‚ÄúConcordance Index Matched Case‚ÄìControl Studies Applications Cancer Risk.‚Äù Statistics Medicine 34 (3): 396‚Äì405.Brooks, Mollie, Ben Bolker, Kasper Kristensen, Martin Maechler, Arni Magnusson, Hans Skaug, Anders Nielsen, Casper Berg, Koen van Bentham. 2022. GlmmTMB: Generalized Linear Mixed Models Using Template Model Builder. https://github.com/glmmTMB/glmmTMB.Brooks, Mollie E., Kasper Kristensen, Koen J. van Benthem, Arni Magnusson, Casper W. Berg, Anders Nielsen, Hans J. Skaug, Martin Maechler, Benjamin M. Bolker. 2017. ‚ÄúglmmTMB Balances Speed Flexibility Among Packages Zero-Inflated Generalized Linear Mixed Modeling.‚Äù R Journal 9 (2): 378‚Äì400. https://journal.r-project.org/archive/2017/RJ-2017-066/index.html.Bryan, Jennifer, Hadley Wickham. 2021. Gh: GitHub ‚ÄôApi‚Äô. https://CRAN.R-project.org/package=gh.Ching, Travers. 2022. Qs: Quick Serialization R Objects. https://github.com/traversc/qs.Cs√°rdi, G√°bor, Linus Torvalds. 2022. Parsedate: Recognize Parse Dates Various Formats, Including Iso 8601 Formats. https://github.com/gaborcsardi/parsedate.Dickie, Melanie, Scott R McNay, Glenn D Sutherland, Michael Cody, Tal Avgar. 2020. ‚ÄúCorridors Risk? Movement Along, Use , Linear Features Varies Predictably Among Large Mammal Predator Prey Species.‚Äù Journal Animal Ecology 89 (2): 623‚Äì34.Dowle, Matt, Arun Srinivasan. 2022. Data.table: Extension ‚ÄòData.frame‚Äò.Fieberg, John, Douglas H Johnson. 2015. ‚ÄúMMI: Multimodel Inference Models Management Implications?‚Äù Journal Wildlife Management 79 (5): 708‚Äì18.Fieberg, John R, James D Forester, Garrett M Street, Douglas H Johnson, Althea ArchMiller, Jason Matthiopoulos. 2018. ‚ÄúUsed-Habitat Calibration Plots: New Procedure Validating Species Distribution, Resource Selection, Step-Selection Models.‚Äù Ecography 41 (5): 737‚Äì52.Fieberg, John, Johannes Signer, Brian Smith, Tal Avgar. 2021. ‚Äú‚Äò‚Äôguide Interpreting Parameters Habitat-Selection Analyses.‚Äù Journal Animal Ecology 90 (5): 1027‚Äì43.Fleming, Chris H, Justin M Calabrese, Thomas Mueller, Kirk Olson, Peter Leimgruber, William F Fagan. 2014. ‚ÄúFine-Scale Foraging Home Ranges: Semivariance Approach Identifying Movement Modes Across Spatiotemporal Scales.‚Äù American Naturalist 183 (5): E154‚ÄìE167.Fortin, Daniel, Marie-Eve Fortin, Hawthorne L Beyer, Thierry Duchesne, Sabrina Courant, Karine Dancose. 2009. ‚ÄúGroup-Size-Mediated Habitat Selection Group Fusion‚ÄìFission Dynamics Bison Predation Risk.‚Äù Ecology 90 (9): 2480‚Äì90.Hijmans, Robert J. 2022. Raster: Geographic Data Analysis Modeling. https://rspatial.org/raster.Landau, William Michael. 2021a. Tarchetypes: Archetypes Targets.‚Äî‚Äî‚Äî. 2021b. ‚ÄúTargets R Package: Dynamic Make-Like Function-Oriented Pipeline Toolkit Reproducibility High-Performance Computing.‚Äù Journal Open Source Software 6 (57): 2959. https://doi.org/10.21105/joss.02959.‚Äî‚Äî‚Äî. 2022a. Tarchetypes: Archetypes Targets. https://CRAN.R-project.org/package=tarchetypes.‚Äî‚Äî‚Äî. 2022b. Targets: Dynamic Function-Oriented Make-Like Declarative Workflows. https://CRAN.R-project.org/package=targets.Muff, Stefanie, Johannes Signer, John Fieberg. 2020. ‚ÄúAccounting Individual-Specific Variation Habitat-Selection Studies: Efficient Estimation Mixed-Effects Models Using Bayesian Frequentist Computation.‚Äù Journal Animal Ecology 89 (1): 80‚Äì92.Northrup, Joseph M, Charles R Anderson Jr, Mevin B Hooten, George Wittemyer. 2016. ‚ÄúMovement Reveals Scale Dependence Habitat Selection Large Ungulate.‚Äù Ecological Applications 26 (8): 2746‚Äì57.Northrup, Joseph M, Mevin B Hooten, Charles R Anderson Jr, George Wittemyer. 2013. ‚ÄúPractical Guidance Characterizing Availability Resource Selection Functions Use‚ÄìAvailability Design.‚Äù Ecology 94 (7): 1456‚Äì63.Northrup, Joseph M, Eric Vander Wal, Maegwin Bonar, John Fieberg, Michel P Laforge, Martin Leclerc, Christina M Prokopenko, Brian D Gerber. 2022. ‚ÄúConceptual Methodological Advances Habitat-Selection Modeling: Guidelines Ecology Evolution.‚Äù Ecological Applications 32 (1): e02470.Pebesma, Edzer. 2018. ‚ÄúSimple Features R: Standardized Support Spatial Vector Data.‚Äù R Journal 10 (1): 439‚Äì46. https://doi.org/10.32614/RJ-2018-009.‚Äî‚Äî‚Äî. 2022. Sf: Simple Features R. https://CRAN.R-project.org/package=sf.Pebesma, Edzer, Roger Bivand. 2021. Sp: Classes Methods Spatial Data. https://CRAN.R-project.org/package=sp.Pebesma, Edzer J., Roger S. Bivand. 2005. ‚ÄúClasses Methods Spatial Data R.‚Äù R News 5 (2): 9‚Äì13. https://CRAN.R-project.org/doc/Rnews/.Prokopenko, Christina M., Mark S. Boyce, Tal Avgar. 2016. ‚ÄúCharacterizing Wildlife Behavioural Responses Roads Using Integrated Step Selection Analysis.‚Äù Edited Ayesha Tulloch. Journal Applied Ecology 54 (2): 470‚Äì79. https://doi.org/10.1111/1365-2664.12768.Prokopenko, Christina M, Mark S Boyce, Tal Avgar. 2017. ‚ÄúExtent-Dependent Habitat Selection Migratory Large Herbivore: Road Avoidance Across Scales.‚Äù Landscape Ecology 32 (2): 313‚Äì25.R Core Team. 2022. R: Language Environment Statistical Computing. Vienna, Austria: R Foundation Statistical Computing. https://www.R-project.org/.Robitaille, Alec L. 2021. Distanceto: Calculate Distance Features. https://CRAN.R-project.org/package=distanceto.Scrafford, Matthew , Tal Avgar, Rick Heeres, Mark S Boyce. 2018. ‚ÄúRoads Elicit Negative Movement Habitat-Selection Responses Wolverines (Gulo Gulo Luscus).‚Äù Behavioral Ecology 29 (3): 534‚Äì42.Signer, Johannes. 2022. Amt: Animal Movement Tools. https://github.com/jmsigner/amt.Signer, Johannes, John Fieberg, Tal Avgar. 2019a. ‚ÄúAnimal Movement Tools (Amt): R Package Managing Tracking Data Conducting Habitat Selection Analyses.‚Äù Ecology Evolution 9 (2): 880‚Äì90.‚Äî‚Äî‚Äî. 2019b. ‚ÄúAnimal Movement Tools (Amt): R Package Managing Tracking Data Conducting Habitat Selection Analyses.‚Äù Ecology Evolution 9: 880‚Äì90. https://doi.org/10.1002/ece3.4823.Ushey, Kevin. 2022. Renv: Project Environments. https://rstudio.github.io/renv/.Wickham, Hadley. 2016. Ggplot2: Elegant Graphics Data Analysis. Springer-Verlag New York. https://ggplot2.tidyverse.org.‚Äî‚Äî‚Äî. 2021a. Conflicted: Alternative Conflict Resolution Strategy. https://CRAN.R-project.org/package=conflicted.‚Äî‚Äî‚Äî. 2021b. Downlit: Syntax Highlighting Automatic Linking. https://CRAN.R-project.org/package=downlit.Wickham, Hadley, Winston Chang, Lionel Henry, Thomas Lin Pedersen, Kohske Takahashi, Claus Wilke, Kara Woo, Hiroaki Yutani, Dewey Dunnington. 2021. Ggplot2: Create Elegant Data Visualisations Using Grammar Graphics. https://CRAN.R-project.org/package=ggplot2.Wickham, Hadley, Jim Hester, Jeroen Ooms. 2021. Xml2: Parse Xml. https://CRAN.R-project.org/package=xml2.Xie, Yihui. 2014. ‚ÄúKnitr: Comprehensive Tool Reproducible Research R.‚Äù Implementing Reproducible Computational Research, edited Victoria Stodden, Friedrich Leisch, Roger D. Peng. Chapman; Hall/CRC. http://www.crcpress.com/product/isbn/9781466561595.‚Äî‚Äî‚Äî. 2015a. Dynamic Documents R Knitr. 2nd ed. Boca Raton, Florida: Chapman; Hall/CRC. http://yihui.org/knitr/.‚Äî‚Äî‚Äî. 2015b. Dynamic Documents R Knitr. 2nd ed. Boca Raton, Florida: Chapman; Hall/CRC. https://yihui.org/knitr/.‚Äî‚Äî‚Äî. 2016. Bookdown: Authoring Books Technical Documents R Markdown. Boca Raton, Florida: Chapman; Hall/CRC. https://bookdown.org/yihui/bookdown.‚Äî‚Äî‚Äî. 2022a. Bookdown: Authoring Books Technical Documents R Markdown.‚Äî‚Äî‚Äî. 2022b. Knitr: General-Purpose Package Dynamic Report Generation R. https://yihui.org/knitr/.Xie, Yihui, J. J. Allaire, Garrett Grolemund. 2018. R Markdown: Definitive Guide. Boca Raton, Florida: Chapman; Hall/CRC. https://bookdown.org/yihui/rmarkdown.Xie, Yihui, Christophe Dervieux, Emily Riederer. 2020. R Markdown Cookbook. Boca Raton, Florida: Chapman; Hall/CRC. https://bookdown.org/yihui/rmarkdown-cookbook.","code":""}]
